
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>网络协议——常见协议 | 这是一个主标题</title>
    <meta name="author" content="CCC" />
    <meta name="description" content="学习一下" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="../../../../../images/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="../../../../../js/lib/highlight.js"></script>



<script src="../../../../../js/lib/preview.js"></script>









<link rel="stylesheet" href="../../../../../css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="../../../../../images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>这是一个主标题</span>
        </a>
        
        <a href="../../../../../index.html">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="../../../../../about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="../../../../../archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="../../../../../categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="../../../../../tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;这是一个主标题</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="../../../../../index.html">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="../../../../../about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="../../../../../archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="../../../../../categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="../../../../../tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>网络协议——常见协议</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/8/1
        </span>
        
        <span class="category">
            <a href="../../../../../categories/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                网络协议
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="../../../../../tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/" style="color: #ffa2c4">
                    网络协议
                </a>
            </span>
            
            <span class="tag">
                
                <a href="../../../../../tags/%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE/" style="color: #00a596">
                    常见协议
                </a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <!-- ![](1.jpg) -->

<h1 id="网络协议"><a href="#网络协议" class="headerlink" title="网络协议"></a>网络协议</h1><span id="more"></span>
<h2 id="TCP-UDP"><a href="#TCP-UDP" class="headerlink" title="TCP&#x2F;UDP"></a>TCP&#x2F;UDP</h2><table>
<thead>
<tr>
<th>类型</th>
<th>特点</th>
<th>性能</th>
<th>应用过场景</th>
<th>首部字节</th>
</tr>
</thead>
<tbody><tr>
<td>TCP</td>
<td>面向连接、可靠、字节流</td>
<td>传输效率慢、所需资源多</td>
<td>文件、邮件传输</td>
<td>20-60</td>
</tr>
<tr>
<td>UDP</td>
<td>无连接、不可靠、数据报文段</td>
<td>传输效率快、所需资源少</td>
<td>语音、视频、直播</td>
<td>8个字节</td>
</tr>
</tbody></table>
<h3 id="TCP三次握手和四次挥手"><a href="#TCP三次握手和四次挥手" class="headerlink" title="TCP三次握手和四次挥手"></a>TCP三次握手和四次挥手</h3><p><img src="/2023/08/01/4-1-%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE/index/tcp.jpg"></p>
<blockquote>
<p><strong>原因为了防止建立重复的连接而损耗资源或造成其他问题</strong></p>
<p><strong>第一次握手</strong><br>第一次握手由客户端向服务器 发出：客户端发送一个TCP数据报，其中，TCP分组的源端口为客户端发起通信建立的进程端口，而目的端口为服务器处理请求的进程端口号，比如80端口。在表示建立连接的TCP分组中，SYN标志位为被置1，则告知服务器发送该分组的目的是请求建立连接，并且当SYN置1时，该分组中的seq字段发送的是初始序列号cilent_isn，初始序列号的取值方案有多种，一般取随机值。</p>
<p><strong>第二次握手</strong><br>第二次握手由服务器向客户端发出：服务器在成功接收了客户端第一次握手发送的分组后，首先需要解析收到的TCP分组，发现SYN置1后，得知这个客户端发送分组的目的是为了建立连接，在确认完毕分组信息后，服务器也会向客户端发送一个TCP分组来代表第二次握手。</p>
<p>这个由服务器发送的TCP分组包含以下内容：</p>
<p>首先将代表建立连接目的的SYN标志位同样置1<br>然后随机地产生服务器端的初始序列号 server_isn在seq字段中发送<br>同时将代表累计确认接收字节位数的ACK确认号发送，该确认号ACK的值为客户端发送的TCP分组中的初始序列号+1,即cilent_isn+1。也就是发送服务器期望接收的下一个字节序号。<br><strong>第三次握手</strong><br>第三次握手由客户端向服务器发出：客户端在接收到服务器第二次握手的回复之后，同样会接收来自于服务器的TCP分组并进行解读：由SYN为1解读该TCP分组的目的是继续建立连接，由分组中的ACK确认号了解到服务器已经成功接收了前cilent_isn个字节的内容，并期望接收第cilent_isn+1个字节的字节序号，同时累计确认来自服务器的初始序列号。并发送最后一个TCP分组给服务器来完成第三次握手。</p>
<p><strong>第一次挥手：</strong> 客户端因为不再有数据发送给服务器，所以向服务器发送FIN报文表示想要关闭连接，不会再发送数据了。同时包含客户端的报文序号M</p>
<p><strong>第二次挥手：</strong> 服务器在接收了来自客户端的FIN报文后，得知客户端不再发送数据，将要关闭连接。但是，此时服务器端获取还有部分数据没有回传给客户端，服务器可能还要向客户端发送一部分数据才能关闭连接。所以服务器不会立马同意关闭连接，而是先发送表示确认信息的ACK报文，该ACK报文中包含了值为M+1的确认号。</p>
<p><strong>第三次挥手：</strong> 在服务器端完成向客户端传送最后的数据后，此时不再有数据需要传输了。那么服务器也准备关闭连接，所以向客户端发送表示关闭连接的FIN报文，报文中包含了服务器端的序号N</p>
<p><strong>第四次挥手：</strong> 在客户端也收到了服务器端发送的FIN报文之后，得知服务器端也可以关闭连接了，此时再向服务器发送最后一次确认报文ACK，使连接成功关闭，ACK报文中的确认号为N+1</p>
</blockquote>
<h3 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h3><blockquote>
<p><strong>格式</strong></p>
<p><img src="/2023/08/01/4-1-%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE/index/udp.jpg"></p>
<ul>
<li>源端口号：表示数据从哪里发送</li>
<li>目的端口号：表示数据要发送到哪里区</li>
<li>16位UDP长度：表示整个数据报（UDP首部+UDP数据）的最大长度</li>
<li>16位UDP校验和：检测数据是否被破坏，如果UDP报文校验和检测出错，就会直接丢弃</li>
</ul>
<p><strong>特点</strong></p>
<ol>
<li>无连接 </li>
<li>不可靠</li>
<li>面向数据报</li>
</ol>
</blockquote>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><blockquote>
<p><strong>HTTP (全称为 “超文本传输协议”) 是一种应用非常广泛的应用层协议。</strong></p>
</blockquote>
<h3 id="tcp协议与http协议"><a href="#tcp协议与http协议" class="headerlink" title="tcp协议与http协议"></a>tcp协议与http协议</h3><blockquote>
<p>从应用领域来说，tcp协议主要用以数据传输控制，而http协议主要用于应用层面的数据交互，本质上两者没有可比性。<br>http协议属于应用层协议，是建立在tcp协议的基础上的，http协议以客户端请求和服务端应答为标准，浏览器通常为客户端，而web服务器称之为服务端；客户端打开任意一个端口向服务端的指定端口发起http请求，首先是发起tcp三次握手，tcp三次握手的目的是建立可靠的数据连接通道，tcp三次握手建立完毕，进行http数据交互，如下图：<br><img src="http.jpg"></p>
</blockquote>
<h3 id="http原理"><a href="#http原理" class="headerlink" title="http原理"></a>http原理</h3><p><img src="/2023/08/01/4-1-%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE/index/HTTP1.JPG"></p>
<blockquote>
<p>客户端浏览器向服务器发起请求request，服务器收到request后进行处理，会产生响应的response信息返回给浏览器，客户端浏览器收到服务器返回的response信息，会对信息进行解析处理，最终用户看到浏览器展示web服务器的网页内容，客户端发起请求request，服务器响应response；</p>
<p>request消息分为3个部分：request line ，request header、空行、body；<br>response消息分为3个部分： response line ，response header，空行、body；</p>
<p>request line，包含三部分：请求方法GET方法、请求 URI、http 协议版本；<br>request header一般包括服务器主机ip，User-Agent表示用户使用的代理软件，一般是指浏览器；<br>空行用来表示请求头结束了；<br>body，报文主体，可以添加任意的其他数据，注意：get方法的body默认为空，post方法的body才有数据；</p>
<p>response line ，响应行，包含了协议版本，状态码和状态信息，200就是状态码，ok就是状态消息；<br>response header，响应头，包含响应时间，服务主机类型等附加信息；<br>空行用来表示响应头结束了；<br>响应的报文主体body就是返回给客户端的网页数据；</p>
<p>下面我们来使用curl命令来看一下request消息和response信息：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">curl -v http://192.168.43.226/index.html		#先启动nginx，再写这条命令执行</span><br><span class="line">*   Trying 192.168.43.226...</span><br><span class="line">* tcp_NODELAY set</span><br><span class="line">* Connected to 192.168.43.226 (192.168.43.226) port 80 (#0)</span><br><span class="line">&gt; GET /index.html http/1.1				#这一行就是请求行request line，包含三部分：请求方法GET方法、请求 URI、http 协议版本</span><br><span class="line">&gt; Host: 192.168.43.226				    #请求头request header，请求头包括服务器主机IP，User-Agent表示用户使用的代理软件，一般是</span><br><span class="line">&gt; User-Agent: curl/7.61.1				# 指浏览器</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;										#这一行空行通过回车符换行符告诉web服务器请求头结束</span><br><span class="line">&gt;										#这里是body消息，但因为GET方法的body默认为空，所以这里没有显示</span><br><span class="line">&lt; http/1.1 200 OK						#response line ，响应行，包含了协议版本，状态码和状态信息，200就是状态码，ok就是状态消息</span><br><span class="line">&lt; Server: nginx/1.18.0					#response header，响应头，包含响应时间，服务主机类型等附加信息</span><br><span class="line">&lt; Date: Wed, 19 May 2021 02:27:09 GMT</span><br><span class="line">&lt; Content-Type: text/html</span><br><span class="line">&lt; Content-Length: 724</span><br><span class="line">&lt; Last-Modified: Sun, 09 May 2021 08:11:51 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; ETag: &quot;60979947-2d4&quot;</span><br><span class="line">&lt; Accept-Ranges: bytes</span><br><span class="line">&lt;										#空行，表示response header结束</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span>							#下面就是响应的报文主体body</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Welcome to nginx!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">35em</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-family</span>: Tahoma, Verdana, Arial, sans-serif;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome to nginx!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>     1.go for it! just do it!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>     2.better late than never.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>     3.Don&#x27;t give up and don&#x27;t give in. <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>     4.one today is worth two tomorrows.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>     5.a bold attempt is half success.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>                             --from web01_port80 server <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>For online documentation and support please refer to</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://nginx.org/&quot;</span>&gt;</span>nginx.org<span class="tag">&lt;/<span class="name">a</span>&gt;</span>.<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">Commercial support is available at</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://nginx.com/&quot;</span>&gt;</span>nginx.com<span class="tag">&lt;/<span class="name">a</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">em</span>&gt;</span>Thank you for using nginx.<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>1、用户在浏览器输入访问地址：<a target="_blank" rel="noopener" href="https://www.baidu.com/">https://www.baidu.com</a><br>2、浏览器请求DNS进行域名解析，从而得到域名对应的IP地址<br>3、浏览器将端口号（默认80）从访问地址中解析出来<br>4、浏览器通过解析出来的IP和端口号与服务器之间进行tcp 3次握手建立一条可靠的tcp连接<br>5、3次握手建立好tcp连接后，浏览器向服务器发送一条http请求报文<br>6、服务器响应并读取浏览器的请求信息，然后返回响应报文<br>7、服务器关闭http连接，关闭tcp连接，浏览器显示访问内容到网页上</p>
<p><strong>统一资源定位符URL</strong></p>
<p>URL由三部分组成：资源类型、存放资源的主机域名、资源文件名<br>也可认为由4部分组成：协议、主机、端口、路径<br>URL的一般语法格式为：protocol :&#x2F;&#x2F; hostname[:port] &#x2F; path &#x2F; [;parameters][?query-string]#fragment</p>
<p><strong>protocol（协议）：</strong>指定使用的传输协议，下表列出 protocol 属性的有效方案名称。 最常用的是http协议，它也是WWW中应用最广的协议，还有ftp协议等，ftp 通过 ftp访问资源，格式 ftp:&#x2F;&#x2F;；<br><strong>hostname（主机名）：</strong>是指存放资源的服务器的域名系统(DNS) 主机名或 IP 地址，有时，在主机名前也可以包含连接到服务器所需的用户名和密码（格式：username:password@hostname）；<br><strong>port（端口号）：</strong>整数，可选，省略时使用服务的默认端口，各种传输协议都有默认的端口号，如http的默认端口为80；<br><strong>path（路径）：</strong>由零或多个“&#x2F;”符号隔开的字符串，一般用来表示主机上的一个目录或文件地址；<br><strong>parameters（参数）：</strong>这是用于指定特殊参数的可选项；<br><strong>query(查询)：</strong>可选，用于给动态网页（如使用CGI、ISAPI、PHP&#x2F;JSP&#x2F;ASP&#x2F;ASP.NET等技术制作的网页）传递参数，可有多个参数，用“&amp;”符号隔开，每个参数的名和值用“&#x3D;”符号隔开；<br><strong>fragment（信息片断）：</strong>字符串，用于指定网络资源中的片断；例如一个网页中有多个名词解释，可使用fragment直接定位到某一名词解释；</p>
<h2 id="http请求方法-最常用"><a href="#http请求方法-最常用" class="headerlink" title="http请求方法(最常用)"></a>http请求方法(最常用)</h2><ol>
<li><p>GET : 客户端请求指定资源信息，服务器返回指定资源     注意：get方法是没有请求报文主体的，post方法才有 </p>
</li>
<li><p>POST : 将客户端的数据提交到服务器，例如：注册表单</p>
</li>
</ol>
</blockquote>
<h2 id="HTTP-SOCKET"><a href="#HTTP-SOCKET" class="headerlink" title="HTTP &amp; SOCKET"></a>HTTP &amp; SOCKET</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p>应用层：HTTP协议，主要解决如何包装数据；</p>
<p>传输层： TCP协议、TPC&#x2F;IP协议；</p>
<p>网络层： IP 协议</p>
<p>socket则是对TCP&#x2F;IP协议的封装和应用，Socket本身并不是协议而是一个调用接口，通过Socket才能使用TCP&#x2F;IP协议。实际上，Socket跟TCP&#x2F;IP协议没有必然的联系。 Socket的出现只是使得程序员更方便地使用TCP&#x2F;IP协议栈而已，从而形成了最基本的函数接口，比如create、 listen、connect、accept、send、read和write等等。</p>
<p>关于TCP &#x2F;IP和HTTP协议的关系，网络有一段比较容易理解的介绍： “我们在传输数据时，可以只使用（传输层）TCP&#x2F;IP协议，但是那样的话，如果没有应用层，便无法识别数据内容，如果想要使传输的数据有意义，则必须使用到应用层协议，应用层协议有很多，比如HTTP、FTP、TELNET等，也可以自己定义应用层协议。WEB使用HTTP协议作应用层协议，以封装 HTTP 文本信息，然后使用TCP&#x2F;IP做传输层协议将它发到网络上。”</p>
</blockquote>
<h3 id="TCP连接"><a href="#TCP连接" class="headerlink" title="TCP连接"></a>TCP连接</h3><blockquote>
<p>建立一个TCP连接需要经过“三次握手”，具体如下：<br>第一次握手：客户端发送请求包到服务器，等待服务器确认<br>第二次握手：服务器响应客户端请求，同时也发送一个回应包给客户端<br>第三次握手：客户端收到服务器的回应包后，向服务器发送确认包</p>
<p>握手过程中传送的包里，不包含数据，三次握手完毕后，客户端与服务端才正式的开始传递数据。<br>TCP一旦连接起来，在客户端和服务端任何一方主动关闭连接之前，TCP连接都将被一直保持下去。<br>断开连接时，服务器和客户端都可以主动发起断开TCP连接的请求，断开过程需要经过“四次握手”</p>
<p>握手过程中传送的包里不包含数据，三次握手完毕后，客户端与服务器才正式开始传送数据。理想状态下，TCP连接一旦建立，在通信双方中的任何一方主动关闭连接之前，TCP 连接都将被一直保持下去。断开连接时服务器和客户端均可以主动发起断开TCP连接的请求，断开过程需要经过“四次挥手”。</p>
</blockquote>
<h3 id="HTTP连接"><a href="#HTTP连接" class="headerlink" title="HTTP连接"></a>HTTP连接</h3><blockquote>
<p>HTTP协议即<strong>超文本传送协议</strong>(Hypertext Transfer Protocol )，是Web联网的基础，也是手机联网常用的协议之一，HTTP协议是建立在TCP协议之上的一种应用。</p>
<p>HTTP连接最显著的特点是客户端发送的每次请求都需要服务器回送响应，在请求结束后，会主动释放连接。从建立连接到关闭连接的过程称为“一次连接”。</p>
<p>1）在HTTP 1.0中，客户端的每次请求都要求建立一次单独的连接，在处理完本次请求后，就自动释放连接。</p>
<p>2）在HTTP 1.1中则可以在一次连接中处理多个请求，并且多个请求可以重叠进行，不需要等待一个请求结束后再发送下一个请求。</p>
<p>由于HTTP在每次请求结束后都会主动释放连接，因此HTTP连接是一种<strong>“短连接”</strong>，要保持客户端程序的在线状态，需要不断地向服务器发起连接请求。通常的做法是即时不需要获得任何数据，客户端也保持每隔一段固定的时间向服务器发送一次“保持连接”的请求，服务器在收到该请求后对客户端进行回复，表明知道客户端“在线”。若服务器长时间无法收到客户端的请求，则认为客户端“下线”，若客户端长时间无法收到服务器的回复，则认为网络已经断开。</p>
</blockquote>
<h3 id="SOCKET原理"><a href="#SOCKET原理" class="headerlink" title="SOCKET原理"></a>SOCKET原理</h3><blockquote>
<p><strong>套接字（socket）概念</strong><br>Socket是通信的基石，是支持TCP&#x2F;IP协议的网络通信的基本操作单元。它是网络通信过程中端点的抽象表示，包含进行网络通信必须的五种信息：连接使用的协议，本地主机的IP地址，本地进程的协议端口，远地主机的IP地址，远地进程的协议端口。<br>应用层通过传输层进行数据通信时，TCP会遇到同时为多个应用程序进程提供并发服务的问题。多个TCP连接或多个应用程序进程可能需要通过同一个 TCP协议端口传输数据。为了区别不同的应用程序进程和连接，许多计算机操作系统为应用程序与TCP／IP协议交互提供了套接字(Socket)接口。应用层可以和传输层通过Socket接口，区分来自不同应用程序进程或网络连接的通信，实现数据传输的并发服务。<br><strong>建立socket连接</strong><br>建立Socket连接至少需要一对套接字，其中一个运行于客户端，称为ClientSocket ，另一个运行于服务器端，称为ServerSocket </p>
<p>套接字之间的连接过程分为三个步骤：服务器监听，客户端请求，连接确认。</p>
<p><strong>服务器监听：</strong>服务器端套接字并不定位具体的客户端套接字，而是处于等待连接的状态，实时监控网络状态，等待客户端的连接请求。</p>
<p><strong>客户端请求：</strong>指客户端的套接字提出连接请求，要连接的目标是服务器端的套接字。为此，客户端的套接字必须首先描述它要连接的服务器的套接字，指出服务器端套接字的地址和端口号，然后就向服务器端套接字提出连接请求。</p>
<p><strong>连接确认：</strong>当服务器端套接字监听到或接收到客户端套接字的连接请求时，就响应客户端套接字的请求，建立一个新的线程，把服务器端套接字的描述发给客户端，一旦客户端确认此描述，双方就正式建立连接。而服务器端套接字继续处于监听状态，继续接收其他客户端套接字的连接请求。</p>
</blockquote>
<h2 id="MQTT"><a href="#MQTT" class="headerlink" title="MQTT"></a>MQTT</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p>MQTT（Message Queuing Telemetry Transport，消息队列遥测传输协议），是一种基于<code>发布/订阅</code>（<code>publish/subscribe</code>）模式的“轻量级”通讯协议，该协议构建于<strong>TCP&#x2F;IP协议</strong>上</p>
<p>MQTT最大优点在于，<strong>用极少的代码和有限的带宽，为连接远程设备提供实时可靠的消息服务</strong>。作为一种低开销、低带宽占用的即时通讯协议，使其在物联网、小型设备、移动应用等方面有较广泛的应用。</p>
</blockquote>
<p><img src="/2023/08/01/4-1-%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE/index/mqtt.jpg"></p>
<h3 id="消息格式"><a href="#消息格式" class="headerlink" title="消息格式"></a>消息格式</h3><blockquote>
<p><strong>消息格式如下</strong></p>
<p>固定报头|可变报头|负载(消息体)</p>
<ol>
<li>固定报头</li>
</ol>
<p><img src="/2023/08/01/4-1-%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE/index/mqtt_1.jpg"></p>
<p><img src="/2023/08/01/4-1-%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE/index/mqtt_2.jpg"></p>
<p><img src="/2023/08/01/4-1-%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE/index/mqtt_3.jpg"></p>
<p><strong>byte2:剩余长度</strong>( Remaining Length)表示当前报文剩余部分的字节数，包括可变报头和负载的数据。剩余长度不包括用于编码剩余长度字段本身的字节数。共1~4个字节，每个字节的低7位用于编码数据，最高位表示是否有更多字节。最大允许发送256M控制报文(0xff,0xff,0xff,0x7f)&#x3D;256M;</p>
<ol start="2">
<li>可变报头</li>
<li>负载（有效消息）</li>
</ol>
</blockquote>
<h3 id="QoS等级"><a href="#QoS等级" class="headerlink" title="QoS等级"></a>QoS等级</h3><blockquote>
<p><strong>level 0：最多一次的传输</strong></p>
<p>消息是基于TCP&#x2F;IP网络传输的。没有回应，在协议中也没有定义重传的语义。消息可能到达服务器1次，也可能根本不会到达。</p>
<p><strong>level 1：至少一次的传输</strong></p>
<p>服务器接收到消息会被确认，通过传输一个PUBACK信息。如果有一个可以辨认的传输失败，无论是通讯连接还是发送设备，还是过了一段时间确认信息没有收到，发送方都会将消息头的DUP位置1，然后再次发送消息。消息最少一次到达服务器。SUBSCRIBE和UNSUBSCRIBE都使用level 1 的QoS。</p>
<p>如果客户端没有接收到PUBACK信息（无论是应用定义的超时，还是检测到失败然后通讯session重启），客户端都会再次发送PUBLISH信息，并且将DUP位置1。当它从客户端接收到重复的数据，服务器重新发送消息给订阅者，并且发送另一个PUBACK消息。</p>
<p><strong>level 2： 只有一次的传输</strong></p>
<p>在QoS level 1上附加的协议流保证了重复的消息不会传送到接收的应用。这是最高级别的传输，当重复的消息不被允许的情况下使用。这样增加了网络流量，但是它通常是可以接受的，因为消息内容很重要。</p>
</blockquote>
<h2 id="物联网常见无线协议"><a href="#物联网常见无线协议" class="headerlink" title="物联网常见无线协议"></a>物联网常见无线协议</h2><table>
<thead>
<tr>
<th align="center">序号</th>
<th align="center">协议</th>
<th align="center">标准</th>
<th align="center">频率</th>
<th align="center">范围</th>
<th align="center">数据速率</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">蓝牙</td>
<td align="center">蓝牙4.2核心规格</td>
<td align="center">2.4GHz（ISM）</td>
<td align="center">50－150米（智能／ BLE）</td>
<td align="center">1Mbps（智能／ BLE）</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">ZigBee</td>
<td align="center">基于IEEE802.15.4的ZigBee 3.0</td>
<td align="center">2.4GHz</td>
<td align="center">10－100米</td>
<td align="center">250kbps</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">6LowPAN</td>
<td align="center">RFC6282</td>
<td align="center">（适用于各种其他网络媒体，包括蓝牙智能（2.4GHz）或ZigBee或低功率射频（亚1GHz）</td>
<td align="center">N ／ A</td>
<td align="center">N ／ A</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">WIFI</td>
<td align="center">基于802.11n</td>
<td align="center">2.4GHz和5GHz频段</td>
<td align="center">约50m</td>
<td align="center">最大600 Mbps，但根据所使用的通道频率和天线数量（最新的802.11－ac标准应提供500Mbps至1Gbps），150－200Mbps更为典型</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">蜂窝</td>
<td align="center">GSM ／ GPRS ／ EDGE（2G），UMTS ／ HSPA（3G），LTE（4G）</td>
<td align="center">900／1800／1900 ／ 2100MHz</td>
<td align="center">GSM最大35km； HSPA最长200公里</td>
<td align="center">35－170kps（GPRS），120－384kbps（EDGE），384Kbps－2Mbps（UMTS），600kbps－10Mbps（HSPA），3－10Mbps</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">NFC</td>
<td align="center">NFC</td>
<td align="center">13.56MHz（ISM）</td>
<td align="center">10厘米</td>
<td align="center">100－420kbps</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">LoRaWAN</td>
<td align="center">LoRaWAN</td>
<td align="center">各种</td>
<td align="center">2－5公里（城市环境），15公里（郊区环境）</td>
<td align="center">0.3－50 kbps</td>
</tr>
</tbody></table>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 这是一个主标题
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;CCC
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="../../../../../js/main.js"></script>
    
    




    
</body>
</html>
